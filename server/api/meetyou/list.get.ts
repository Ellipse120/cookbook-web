import { writeFile, access, constants, readFile } from 'node:fs/promises'
import { resolve } from 'node:path'
import { sum } from 'es-toolkit/math'

const mock = {
  code: 0,
  data: {
    baby_info: {
      birthday: '2025-09-19',
      common_baby_id: 266913376,
      header: 'https://sc.seeyouyima.com/bbj/default-avatar-baby-boy.png',
      id: 124116844,
      nickname: 'å°æ»¡',
    },
    current_user: {
      can_invite: true,
      can_query: true,
      can_record: true,
      id: 608367633,
      relation: 2,
      relation_name: 'çˆ¸çˆ¸',
    },
    list: [
      {
        date: '2025-12-26',
        records: [
          {
            id: 4780506297,
            user_id: 608367633,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-26 23:18:00',
            end_at: '2025-12-26 23:24:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-26 23:26:12',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4780536597,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-26 22:25:00',
            end_at: '2025-12-26 23:16:00',
            record_detail: {
              last_side: 'left',
              left: 1380,
              right: 1500,
              time_source: 2,
            },
            quantity: 2880,
            remark: '',
            status: 1,
            update_at: '2025-12-26 23:29:51',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å³25åˆ†é’Ÿ->å·¦23åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4780271245,
            user_id: 608367633,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-26 22:09:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-26 22:09:09',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4780251739,
            user_id: 608367633,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-26 21:37:25',
            end_at: '2025-12-26 22:04:19',
            record_detail: {
              time_source: 1,
            },
            quantity: 1614,
            remark: '',
            status: 1,
            update_at: '2025-12-26 22:04:19',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†27åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 108630081,
          },
          {
            id: 4780270998,
            user_id: 608367633,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-26 20:09:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-26 22:09:05',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4779619853,
            user_id: 409898538,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-26 19:07:00',
            end_at: '2025-12-26 19:15:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-26 19:45:22',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4779621089,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-26 18:53:00',
            end_at: '2025-12-26 19:06:00',
            record_detail: {
              last_side: 'right',
              left: 480,
              right: 300,
              time_source: 2,
            },
            quantity: 780,
            remark: '',
            status: 1,
            update_at: '2025-12-26 19:45:08',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å·¦8åˆ†é’Ÿ->å³5åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4779122217,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-26 16:56:00',
            end_at: '2025-12-26 17:40:00',
            record_detail: {
              last_side: 'left',
              left: 900,
              right: 1500,
              time_source: 2,
            },
            quantity: 2400,
            remark: '',
            status: 1,
            update_at: '2025-12-26 17:44:45',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å³25åˆ†é’Ÿ->å·¦15åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4779616720,
            user_id: 409898538,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-26 15:45:20',
            end_at: '2025-12-26 19:00:00',
            record_detail: {
              time_source: 2,
            },
            quantity: 11680,
            remark: '',
            status: 1,
            update_at: '2025-12-26 19:43:53',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†3å°æ—¶15åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 108502684,
          },
          {
            id: 4778556927,
            user_id: 608367633,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-26 14:12:00',
            end_at: '2025-12-26 14:38:00',
            record_detail: {
              time_source: 2,
            },
            quantity: 1560,
            remark: '',
            status: 1,
            update_at: '2025-12-26 15:31:14',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†26åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 108474213,
          },
          {
            id: 4778337372,
            user_id: 608367633,
            uni: '5_0',
            record_type: 5,
            record_category: 0,
            start_at: '2025-12-26 13:40:00',
            end_at: '2025-12-26 14:20:00',
            record_detail: {
              time_source: 2,
            },
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-26 14:36:43',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'æ´—æ¾¡',
            record_content: '40åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4778342605,
            user_id: 608367633,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-26 13:35:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-26 14:38:02',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4778339502,
            user_id: 608367633,
            uni: '8_0',
            record_type: 8,
            record_category: 0,
            start_at: '2025-12-26 13:13:00',
            end_at: '2025-12-26 13:28:00',
            record_detail: {
              event_name: 'å‰ƒèƒŽæ¯›',
              time_source: 2,
            },
            quantity: 900,
            remark: '',
            status: 1,
            update_at: '2025-12-26 14:37:53',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'å‰ƒèƒŽæ¯›',
            record_content: '15åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4777943588,
            user_id: 608367633,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-26 13:00:00',
            end_at: '2025-12-26 13:07:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-26 13:07:23',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4778658136,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-26 11:48:00',
            end_at: '2025-12-26 12:40:00',
            record_detail: {
              last_side: 'left',
              left: 1200,
              right: 1920,
              time_source: 2,
            },
            quantity: 3120,
            remark: '',
            status: 1,
            update_at: '2025-12-26 15:55:41',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å³32åˆ†é’Ÿ->å·¦20åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4777393334,
            user_id: 608367633,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-26 10:47:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-26 11:07:00',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4777279949,
            user_id: 608367633,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-26 08:41:14',
            end_at: '2025-12-26 10:40:00',
            record_detail: {
              time_source: 2,
            },
            quantity: 7126,
            remark: 'ç¬¬ä¸€æ¬¡ç™½å¤©ç¡åœ¨äº†åºŠä¸Šï¼Œä¸ç”¨æ‚ç€ç¡ðŸ«¥ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰',
            status: 1,
            update_at: '2025-12-26 14:36:22',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†1å°æ—¶59åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 108333989,
          },
          {
            id: 4776718890,
            user_id: 608367633,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-26 08:35:00',
            end_at: '2025-12-26 08:41:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-26 08:41:20',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4777399857,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-26 06:36:00',
            end_at: '2025-12-26 07:36:00',
            record_detail: {
              last_side: 'left',
              left: 3600,
              time_source: 2,
            },
            quantity: 3600,
            remark: '',
            status: 1,
            update_at: '2025-12-26 11:08:33',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å·¦1å°æ—¶',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4777443787,
            user_id: 409898538,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-26 06:18:00',
            end_at: '2025-12-26 08:30:00',
            record_detail: {
              time_source: 2,
            },
            quantity: 7920,
            remark: '',
            status: 1,
            update_at: '2025-12-26 11:18:50',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†2å°æ—¶12åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4776239824,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-26 06:03:00',
            end_at: '2025-12-26 06:29:22',
            record_detail: {
              last_side: 'right',
              right: 1560,
              time_source: 1,
            },
            quantity: 1560,
            remark: '',
            status: 1,
            update_at: '2025-12-26 06:29:28',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å³26åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4776266271,
            user_id: 409898538,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-26 05:50:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-26 06:39:19',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4775832322,
            user_id: 608367633,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-26 03:22:00',
            end_at: '2025-12-26 03:27:00',
            record_detail: {
              bottle_feed_capacity: 90,
            },
            quantity: 90,
            remark: '',
            status: 1,
            update_at: '2025-12-26 03:53:20',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '90ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4775847630,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-26 02:10:00',
            end_at: '2025-12-26 03:20:00',
            record_detail: {
              last_side: 'right',
              left: 1800,
              right: 1200,
              time_source: 2,
            },
            quantity: 3000,
            remark: '',
            status: 1,
            update_at: '2025-12-26 03:32:26',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å·¦30åˆ†é’Ÿ->å³20åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4776096477,
            user_id: 409898538,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-26 00:00:00',
            end_at: '2025-12-26 05:02:00',
            record_detail: {
              relation_id: 4776096476,
              time_source: 1,
            },
            quantity: 18120,
            remark: '',
            status: 1,
            update_at: '2025-12-26 05:28:38',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†5å°æ—¶2åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 108192515,
          },
        ],
        summary: {
          date: '2025-12-26',
          detail: [
            {
              uni: '1_11',
              name: 'æ¯ä¹³',
              record_type: 1,
              count: 7,
              time: 17340,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '1_13',
              name: 'é…æ–¹å¥¶',
              record_type: 1,
              count: 5,
              time: 0,
              milliliter: 490,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '2_0',
              name: 'ç¡çœ ',
              record_type: 2,
              count: 6,
              time: 48020,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '4_0',
              name: 'æ¢å°¿å¸ƒ',
              record_type: 4,
              count: 5,
              time: 0,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '5_0',
              name: 'æ´—æ¾¡',
              record_type: 5,
              count: 1,
              time: 2400,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '8_0',
              name: 'å…¶ä»–äº‹ä»¶',
              record_type: 8,
              count: 1,
              time: 900,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
          ],
        },
      },
      {
        date: '2025-12-25',
        records: [
          {
            id: 4775123020,
            user_id: 608367633,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-25 22:18:00',
            end_at: '2025-12-25 22:24:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-25 22:24:12',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4776096476,
            user_id: 409898538,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-25 21:45:00',
            end_at: '2025-12-25 23:59:59',
            record_detail: {
              time_source: 1,
            },
            quantity: 8099,
            remark: '',
            status: 1,
            update_at: '2025-12-26 05:28:38',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†2å°æ—¶15åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 108192515,
          },
          {
            id: 4775113997,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-25 21:33:00',
            end_at: '2025-12-25 22:16:31',
            record_detail: {
              last_side: 'left',
              left: 900,
              right: 1320,
              time_source: 1,
            },
            quantity: 2220,
            remark: '',
            status: 1,
            update_at: '2025-12-25 22:16:31',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å³22åˆ†é’Ÿ->å·¦15åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4775053641,
            user_id: 409898538,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-25 21:25:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-25 22:01:30',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4774507690,
            user_id: 409898538,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-25 19:45:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-25 20:03:00',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4774199163,
            user_id: 409898538,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-25 18:40:00',
            end_at: '2025-12-25 18:46:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-25 18:49:09',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4774414494,
            user_id: 409898538,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-25 18:00:34',
            end_at: '2025-12-25 19:41:27',
            record_detail: {
              time_source: 1,
            },
            quantity: 6053,
            remark: '',
            status: 1,
            update_at: '2025-12-25 19:41:27',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†1å°æ—¶41åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 108103375,
          },
          {
            id: 4774198785,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-25 17:38:00',
            end_at: '2025-12-25 18:38:00',
            record_detail: {
              left: 900,
              right: 1800,
              time_source: 2,
            },
            quantity: 2700,
            remark: '',
            status: 1,
            update_at: '2025-12-25 18:49:19',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å·¦15åˆ†é’Ÿï¼Œå³30åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4773902290,
            user_id: 409898538,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-25 15:46:00',
            end_at: '2025-12-25 17:36:00',
            record_detail: {
              time_source: 1,
            },
            quantity: 6600,
            remark: '',
            status: 1,
            update_at: '2025-12-25 17:38:17',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†1å°æ—¶50åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 108044387,
          },
          {
            id: 4773101132,
            user_id: 409898538,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-25 14:10:00',
            end_at: '2025-12-25 14:20:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-25 14:26:12',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4773130521,
            user_id: 409898538,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-25 13:24:01',
            end_at: '2025-12-25 14:33:18',
            record_detail: {
              time_source: 1,
            },
            quantity: 4157,
            remark: '',
            status: 1,
            update_at: '2025-12-25 14:33:19',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†1å°æ—¶9åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 108010248,
          },
          {
            id: 4773103206,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-25 13:18:00',
            end_at: '2025-12-25 14:09:00',
            record_detail: {
              last_side: 'left',
              left: 1080,
              right: 1800,
              time_source: 2,
            },
            quantity: 2880,
            remark: '',
            status: 1,
            update_at: '2025-12-25 14:26:46',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å³30åˆ†é’Ÿ->å·¦18åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4772969210,
            user_id: 409898538,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-25 13:10:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-25 13:54:22',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4772709504,
            user_id: 608367633,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-25 11:13:43',
            end_at: '2025-12-25 12:58:33',
            record_detail: {
              time_source: 1,
            },
            quantity: 6290,
            remark: '',
            status: 1,
            update_at: '2025-12-25 12:58:33',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†1å°æ—¶45åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 107929248,
          },
          {
            id: 4771933708,
            user_id: 608367633,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-25 10:03:00',
            end_at: '2025-12-25 10:09:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-25 10:09:30',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4772128025,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-25 09:06:00',
            end_at: '2025-12-25 10:02:00',
            record_detail: {
              last_side: 'left',
              left: 600,
              right: 2400,
              time_source: 2,
            },
            quantity: 3000,
            remark: '',
            status: 1,
            update_at: '2025-12-25 10:48:56',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å³40åˆ†é’Ÿ->å·¦10åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4771691073,
            user_id: 409898538,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-25 08:55:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-25 09:09:43',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4771578098,
            user_id: 409898538,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-25 07:18:25',
            end_at: '2025-12-25 08:10:00',
            record_detail: {
              time_source: 2,
            },
            quantity: 3095,
            remark: '',
            status: 1,
            update_at: '2025-12-25 08:45:43',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†52åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 107849602,
          },
          {
            id: 4770993262,
            user_id: 608367633,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-25 06:05:00',
            end_at: '2025-12-25 06:10:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-25 06:10:57',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4770994448,
            user_id: 608367633,
            uni: '4_0',
            record_type: 4,
            record_category: 41,
            start_at: '2025-12-25 05:25:00',
            end_at: '',
            record_detail: {},
            quantity: 0,
            remark: '',
            status: 1,
            update_at: '2025-12-25 06:07:52',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'æ¢å°¿å¸ƒ',
            record_content: 'å˜˜å˜˜',
            unit_type: 0,
            draft_id: 0,
          },
          {
            id: 4771015024,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-25 05:12:00',
            end_at: '2025-12-25 05:50:00',
            record_detail: {
              last_side: 'left',
              left: 1080,
              right: 1200,
              time_source: 2,
            },
            quantity: 2280,
            remark: '',
            status: 1,
            update_at: '2025-12-25 06:17:02',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å³20åˆ†é’Ÿ->å·¦18åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4770524070,
            user_id: 608367633,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-25 02:24:00',
            end_at: '2025-12-25 02:29:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-25 02:29:53',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
          {
            id: 4770568294,
            user_id: 409898538,
            uni: '1_11',
            record_type: 1,
            record_category: 11,
            start_at: '2025-12-25 01:49:00',
            end_at: '2025-12-25 02:20:00',
            record_detail: {
              last_side: 'left',
              left: 1080,
              right: 1080,
              time_source: 2,
            },
            quantity: 2160,
            remark: '',
            status: 1,
            update_at: '2025-12-25 02:48:24',
            can_edit: true,
            follower: {
              user_id: 409898538,
              relation_name: 'å¦ˆå¦ˆ',
            },
            record_type_name: 'æ¯ä¹³',
            record_content: 'å³18åˆ†é’Ÿ->å·¦18åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 0,
          },
          {
            id: 4771002960,
            user_id: 608367633,
            uni: '2_0',
            record_type: 2,
            record_category: 0,
            start_at: '2025-12-25 00:00:00',
            end_at: '2025-12-25 05:48:00',
            record_detail: {
              relation_id: 4771002959,
              time_source: 2,
            },
            quantity: 20880,
            remark: '',
            status: 1,
            update_at: '2025-12-25 06:17:39',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'ç¡çœ ',
            record_content: 'ç¡äº†5å°æ—¶48åˆ†é’Ÿ',
            unit_type: 1,
            draft_id: 107760456,
          },
        ],
        summary: {
          date: '2025-12-25',
          detail: [
            {
              uni: '1_11',
              name: 'æ¯ä¹³',
              record_type: 1,
              count: 6,
              time: 15240,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '1_13',
              name: 'é…æ–¹å¥¶',
              record_type: 1,
              count: 6,
              time: 0,
              milliliter: 600,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '2_0',
              name: 'ç¡çœ ',
              record_type: 2,
              count: 7,
              time: 55174,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '4_0',
              name: 'æ¢å°¿å¸ƒ',
              record_type: 4,
              count: 5,
              time: 0,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
          ],
        },
        append_params: [
          {
            key: 'tab',
            value: '1',
          },
        ],
      },
      {
        date: '2025-12-24',
        records: [
          {
            id: 4770072167,
            user_id: 608367633,
            uni: '1_13',
            record_type: 1,
            record_category: 13,
            start_at: '2025-12-24 22:57:00',
            end_at: '2025-12-24 23:03:00',
            record_detail: {
              bottle_feed_capacity: 100,
            },
            quantity: 100,
            remark: '',
            status: 1,
            update_at: '2025-12-24 23:03:35',
            can_edit: true,
            follower: {
              user_id: 608367633,
              relation_name: 'çˆ¸çˆ¸',
            },
            record_type_name: 'é…æ–¹å¥¶',
            record_content: '100ml',
            unit_type: 2,
            draft_id: 0,
          },
        ],
        summary: {
          date: '2025-12-24',
          detail: [
            {
              uni: '1_11',
              name: 'æ¯ä¹³',
              record_type: 1,
              count: 6,
              time: 13740,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '1_13',
              name: 'é…æ–¹å¥¶',
              record_type: 1,
              count: 7,
              time: 0,
              milliliter: 660,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '2_0',
              name: 'ç¡çœ ',
              record_type: 2,
              count: 6,
              time: 41719,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
            {
              uni: '4_0',
              name: 'æ¢å°¿å¸ƒ',
              record_type: 4,
              count: 4,
              time: 0,
              milliliter: 0,
              gram: 0,
              new_gram: '',
            },
          ],
        },
      },
    ],
  },
  message: '',
}

const filePath = 'public/meetyou/'
const fileName = 'baby_list.json'
const jsonPath = filePath + fileName

const url = 'https://api-bbj.meiyou.com/v3/life/record/list'
const babyId = 124116844
const authorization = 'XDS 7.u7Ii3wNnLBUbNFKKMWyjrgADd0tbVSaW_mL309JXJr0'
const red_dot_cond_days_x = 0
const size = 50

const headers = {
  'Host': 'api-bbj.meiyou.com',
  'source': 'IMYHomeRelativeContainerVC',
  'lang': 'zh',
  'User-Agent': 'Seeyou/8.99.0 (iPhone; iOS 18.6.2; Scale/3.00)',
  'isol': '1372-2-82-1,1374-2-82-1,1379-2-82-1,1383-2-82-1,1384-2-82-1,1392-2-82-1',
  'sv': 'KK77',
  'session-id': 1766788216439,
  'myclient': '0120899000000000',
  'recomm': 0,
  'bbid': 266913376,
  'exp': '105-267,175-889,256-704,304-836,309-846,319-871,336-914,337-1082,368-1022,381-1061,412-1143,441-1294,512-1487,513-1490,524-1520,530-1535,536-1551,540-1578,550-1621,586-1772,620-1902,646-1980,648-1988,680-2101,686-2118,704-2197,705-2199,724-2286,771-2561,776-2582,777-2585,806-2685,835-2794,846-2867,848-2876,849-2879,853-2955,856-2906,861-2928,863-2932,865-2940,887-3129,890-3139,892-3151,893-3153,896-3165,898-3169,915-3224,927-3292,942-3398,949-3453,953-3463,959-3486,967-3584,968-3586,969-3588,979-3645,981-3659,984-3699,997-3837,1001-3841,1002-3846,1007-4030,1015-4000,1022-4102,1029-4208,1033-4201,1064-4405,1073-4476,1080-4507,1081-4509,1101-4611,1108-4651,1117-4882,1118-4694,1123-4783,1134-5080,1152-4978,1160-5050,1163-5056,1164-5061,1166-5069,1169-5098,1189-5267,1190-5271,1191-5275,1192-5279,1198-5372,1199-5375,1204-5403,1209-5450,1244-5867,1253-5567,1265-5650,1273-5724,1287-6170,1289-5884,1296-5942,1298-5961,1304-6270,1307-6022,1312-6140,1323-6155,1329-6188,1341-6323,1345-6349,1348-6361,1353-6394,1354-6400,1377-6807,1380-6835,1382-6860,1389-6963,1394-7075,1410-7381,1422-7612,1423-7632,1427-7708,1436-7818,1438-7850,1439-7870,1450-8030,1451-8056,1454-8099,1479-8813,1480-8378,1485-8455,1487-8461,1490-8511,1491-8542,1497-8630,1507-8702,1508-8704,1511-8746,1523-9120,1528-8906,1541-9002,1547-9072,1553-9136,1559-9223,1566-9264,1571-9428,1577-9454,1578-9468,1579-9471,1589-9609,1591-9655,1594-9672,1598-9705,1605-9789,1613-9869,1616-9926,1619-9975,1625-9997,1630-10016,1640-10101,1646-10223,1648-10247,1658-10385,1660-10416,1670-10527,1676-10582,1677-10585,1687-10634,1689-10645,1702-10742,1706-10780,1711-10820,1712-10824,1717-10867,1718-10874,1720-10888,1722-10914,1731-11028,1732-11032,1734-11048,1742-11093,1743-11159,1751-11142,1752-11152,1757-11190,1758-11195,1759-11203,1760-11208,1775-11288,1778-11312,1783-11423,1787-11450,1796-11488,1797-11499,1800-11948,1804-11539,1807-11571,1809-11852,1810-11613,1811-11615,1814-11638,1816-11644,1819-11652,1821-11667,1823-11689,1828-11720,1832-11755,1833-11759,1838-11786,1840-11800,1848-11857,1853-11872,1854-11876,1855-11880,1861-11906,1864-11916,1865-11920,1866-11929,1870-11956,1877-11976,1878-11980,1881-11989,1882-11992,1885-12004,1892-12033,1894-12050,1899-12070,1902-12083,1903-12088,1904-12091,1919-12149,1922-12161,1923-12164,1938-12223,1951-12275,1952-12279,1956-12298,1974-12383,1983-12411,1987-12435,1995-12473,2032-12640',
  'statinfo': 'bR5QoBSXTFmhKTdgY01mg2NFTs+ZrKZPh2xyerr+dgETXwYCYMD/gMmFE/NZToRMTvIrmuAwFt0IVFUgZhH0Q2IvnDrj9uS3U2BGtzI0FfQ1GMFfqALIQLOUnPw9L7MsvGKa/TIgVtqE4QXnk3MZRyMgdEp9X/u6ZKWhNFjSYgTD3yKCecMt8do6DIFqqa8crmy9UekNY7cJNVnNo9SbZJA3kxkmREVM2ct718l2tZN13P2ZwhJ2TTEL/eG8MiGd3GPmQWSX6PJ3LCyv3ZdLEAq/icfTXuD98U1FSYxaZeVcDqdS5UqSXpRfGAdo9cGxoOnP4jTXbJbu59RhZ1/i7by010/RxoqqUlKAd/PPtxFUNhpt6mg/wVb4qC0qQ9oGjRIsQn7Lp5apAj98opLqx0p6fm824n1ZCHs3Jno09HrZYuMiQD3/+e5WqQeN5roIn6WHHon5ylkaeiI1VISnqR4bhPeZBLha3Ot3Wi8LQWtV7NSbRsx7LOuJ0eF10mkLK6JOytu1SuOqy3o3/F47wfDFq2H4rv55lZEvw5MCC462VG16KvG6RwBfyUViPbKLUBaAW83RRJ4jnpkLv6R7IfI99B1wtob5mfe2XPi1GtaVRL/SVHjmVXOSGvdGP9uS8AY5D045+Vrdye98jXcKBwLeU1pmR9CPDMPKsOqEjJW+RxMEdCCUlTBhKcXWQhhtJdmoDQYvA5Vu6FFdcxoDWIss/tuK3Qewpmt40Bj9y+vuhEUF9gmN9fLlmUKCfysU3H+Nj/RiF/sQUAQJDrom3cQ8Myaau+Hte8lHvnPmj/FJnV3A6ky6Ay2OnnzM1hPBvEoxvLkVo057GPDOduXAYiCjULTgJmgC4XINSQT7mtXwRS4Ady+srIO+Hqtu15cL7VCy378dPq0LCdKC2lRLgxdaRrYlvTRpB0zvAsBDTpy3JSf/FOt1ZGaEwfyi6QkOb1kV6DKVuX4OJ9+ZLkBl74ycpbMT34d+3X/bV6U1rek=',
  'open-person-search-recom': 2,
  'open-person-eb-recomm': 2,
  'myappinfo': '01-2-8.99.0.0-0000-0',
  'x-visit-mode': 1,
  'bbday': 20250919,
  'Authorization': authorization,
  'scale': 3.0,
  'Accept-Language': 'zh-Hans-CN;q=1, en-CN;q=0.9',
  'open-person-ad': 2,
  'Connection': 'keep-alive',
  'themeid': 0,
  'Accept': '*/*',
  'mode': 10,
  'Accept-Encoding': 'gzip, deflate, br',
}

export default defineEventHandler(async (event) => {
  const today = new Date().toISOString().split('T')[0]
  const query = getQuery<{ dates: string[] }>(event)
  const dates: Array<string> = query.dates || [today]
  const begin_date = Array.isArray(dates) ? dates[0] : dates

  let currentData = []

  await access(jsonPath, constants.F_OK).catch(async () => {
    await writeFile(jsonPath, JSON.stringify([], null, 2), {
      flag: 'wx',
    })
  })

  const content = await readFile(resolve(jsonPath), { encoding: 'utf-8' })

  currentData = JSON.parse(content)

  if (currentData.filter(item => dates.includes(item.date)).length) {
    return currentData
  }
  else {
    const { data } = await $fetch<MeetyouResponse>(url, {
      headers,
      params: {
        baby_id: babyId,
        red_dot_cond_days_x,
        size,
        begin_date,
      },
    })
    const dataOfDay = data.list[0]

    const detailOfDay: { count: number }[] = dataOfDay.summary.detail
    const isValidData = sum(detailOfDay.map(detail => detail.count)) === dataOfDay.records.length

    if (isValidData) {
      currentData = [...currentData, dataOfDay]
      await writeFile(jsonPath, JSON.stringify(currentData, null, 2))
    }

    return currentData
  }
})
